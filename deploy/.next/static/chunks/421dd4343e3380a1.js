(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,686037,e=>{"use strict";let t=(0,e.i(546185).default)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);e.s(["CreditCard",()=>t],686037)},988243,e=>{"use strict";var t=e.i(489989),s=e.i(297522),r=e.i(546185);let a=(0,r.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),l=(0,r.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),o=s.forwardRef(({className:e,containerClassName:r,...o},i)=>{let[c,n]=s.useState(!1);return(0,t.jsxs)("div",{className:`relative ${r||""}`,children:[(0,t.jsx)("input",{type:c?"text":"password",className:`block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-[#B70126] sm:text-sm sm:leading-6 px-3 pr-10 ${e||""}`,ref:i,...o}),(0,t.jsxs)("button",{type:"button",onClick:()=>{n(!c)},className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-500 focus:outline-none",tabIndex:-1,children:[c?(0,t.jsx)(l,{className:"h-5 w-5","aria-hidden":"true"}):(0,t.jsx)(a,{className:"h-5 w-5","aria-hidden":"true"}),(0,t.jsx)("span",{className:"sr-only",children:c?"Hide password":"Show password"})]})]})});o.displayName="PasswordInput",e.s(["PasswordInput",()=>o],988243)},439914,e=>{"use strict";let t=(0,e.i(546185).default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>t],439914)},765179,e=>{"use strict";var t=e.i(489989),s=e.i(897686),r=e.i(578211),a=e.i(297522);let l=(0,e.i(546185).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var o=e.i(686037),i=e.i(439914),c=e.i(319541),n=e.i(988243);function d(){let{items:e,total:d,isLoading:m,clearCart:u}=(0,s.useCart)(),h=(0,r.useRouter)(),{t:x}=(0,c.useTranslation)(),[p,b]=(0,a.useState)(!1),[f,g]=(0,a.useState)({firstName:"",lastName:"",email:"",confirmEmail:"",country:"",phone:"",age:""}),[y,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[k,w]=(0,a.useState)(0),[C,S]=(0,a.useState)(null),[P,T]=(0,a.useState)("idle"),[I,O]=(0,a.useState)(""),[$,q]=(0,a.useState)(!1),[E,M]=(0,a.useState)(null),[L,D]=(0,a.useState)(""),[F,A]=(0,a.useState)(""),R=async()=>{if(f.email!==f.confirmEmail)return void alert(x("checkout.emailsDoNotMatch")||"Los correos no coinciden");q(!0);try{(await fetch("/api/auth/otp/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f.email})})).ok?(T("sent"),alert(x("checkout.codeSent"))):alert(x("checkout.errorSending"))}catch(e){console.error(e),alert(x("checkout.errorSending"))}finally{q(!1)}},z=async()=>{q(!0);try{let e=await fetch("/api/auth/otp/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f.email,code:I})}),t=await e.json();e.ok?(T("verified"),M(t.verificationToken)):alert(t.error||x("checkout.invalidCode"))}catch(e){console.error(e),alert(x("checkout.invalidCode"))}finally{q(!1)}},J=async()=>{if(N(""),y.trim())try{let t=await fetch("/api/coupons/validate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:y,cartItems:e})}),s=await t.json();s.valid?(w(s.discountAmount),S(s.coupon.code),j("")):(N(s.message||x("checkout.invalidCoupon")),w(0),S(null))}catch(e){console.error("Error validating coupon:",e),N(x("checkout.invalidCoupon"))}};if((0,a.useEffect)(()=>{m||0!==e.length||h.push("/courses")},[e,m,h]),0===e.length)return null;let B=e=>{let{name:t,value:s}=e.target;g(e=>({...e,[t]:s}))},U=async t=>{if(t.preventDefault(),"verified"!==P)return void alert(x("checkout.emailVerificationRequired"));if(L!==F)return void alert(x("checkout.passwordsMismatch"));b(!0);try{let t=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e.map(e=>({courseId:e.courseId})),billingDetails:f,couponCode:C,verificationToken:E,password:L,country:f.country,phone:f.phone,age:parseInt(f.age)})}),s=await t.json();if(!t.ok)throw Error(s.error||"Something went wrong");await u(),h.push(`/checkout/success?orderId=${s.orderId}&orderNumber=${s.orderNumber}`)}catch(e){console.error("Checkout error:",e),alert(x("checkout.errorProcessing"))}finally{b(!1)}};return(0,t.jsx)("div",{className:"bg-slate-50 min-h-screen pt-32 pb-16",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"text-center mb-12",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-slate-900 mb-4",style:{fontFamily:"var(--font-bebas)"},children:x("checkout.title")}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2 text-slate-600",children:[(0,t.jsx)(i.Lock,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:x("checkout.securePayment")})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-slate-200",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,t.jsx)(l,{className:"w-5 h-5 text-primary"}),x("checkout.personalInfo")]}),(0,t.jsxs)("form",{id:"checkout-form",onSubmit:U,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.firstName")}),(0,t.jsx)("input",{type:"text",name:"firstName",value:f.firstName,onChange:B,required:!0,className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.lastName")}),(0,t.jsx)("input",{type:"text",name:"lastName",value:f.lastName,onChange:B,required:!0,className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.email")}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("input",{type:"email",name:"email",value:f.email,onChange:B,required:!0,placeholder:"ejemplo@correo.com",disabled:"verified"===P,className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent disabled:bg-slate-100 disabled:text-slate-500"}),"verified"!==P&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Confirma tu Correo"}),(0,t.jsx)("input",{type:"email",name:"confirmEmail",value:f.confirmEmail,onChange:B,required:!0,onPaste:e=>e.preventDefault(),placeholder:"Confirma tu correo",className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,t.jsxs)("div",{className:"flex justify-end",children:["idle"===P&&(0,t.jsx)("button",{type:"button",onClick:R,disabled:!f.email||!f.confirmEmail||f.email!==f.confirmEmail||$,className:"bg-slate-800 text-white px-4 py-2 rounded-lg hover:bg-slate-700 disabled:opacity-50 text-sm whitespace-nowrap w-full sm:w-auto",children:$?x("checkout.verifying"):x("checkout.verify")}),"verified"===P&&(0,t.jsxs)("span",{className:"flex items-center text-green-600 font-medium px-2",children:[(0,t.jsx)(l,{className:"w-4 h-4 mr-1"})," ",x("checkout.verified")]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.country")}),(0,t.jsx)("input",{type:"text",name:"country",value:f.country,onChange:B,required:!0,placeholder:x("checkout.countryPlaceholder"),className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"WhatsApp (Obligatorio)"}),(0,t.jsx)("input",{type:"tel",name:"phone",value:f.phone,onChange:B,required:!0,placeholder:"Ej: +52 55...",className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.age")}),(0,t.jsx)("input",{type:"number",name:"age",value:f.age,onChange:B,required:!0,min:"18",max:"100",className:"w-full px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),"sent"===P&&(0,t.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.otpLabel")}),(0,t.jsxs)("p",{className:"text-xs text-slate-500 mb-2",children:[x("checkout.otpSentTo")," ",f.email]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:I,onChange:e=>O(e.target.value),placeholder:x("checkout.otpPlaceholder"),className:"flex-1 px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent"}),(0,t.jsx)("button",{type:"button",onClick:z,disabled:!I||$,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50 text-sm",children:$?x("checkout.confirming"):x("checkout.confirm")})]})]}),"verified"===P&&(0,t.jsxs)("div",{className:"space-y-4 pt-4 border-t border-slate-100",children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-slate-900",children:x("checkout.createPassword")}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.password")}),(0,t.jsx)(n.PasswordInput,{value:L,onChange:e=>D(e.target.value),required:!0,minLength:6})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:x("checkout.confirmPassword")}),(0,t.jsx)(n.PasswordInput,{value:F,onChange:e=>A(e.target.value),required:!0,minLength:6})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-slate-200",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,t.jsx)(o.CreditCard,{className:"w-5 h-5 text-primary"}),x("checkout.paymentMethod")]}),(0,t.jsxs)("div",{className:"p-4 border-2 border-primary bg-red-50 rounded-xl flex items-center gap-4 cursor-pointer",children:[(0,t.jsx)("div",{className:"w-4 h-4 rounded-full bg-primary border-4 border-white shadow-sm ring-1 ring-primary"}),(0,t.jsx)("span",{className:"font-medium text-slate-900",children:x("checkout.creditCard")})]})]})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-slate-200 sticky top-32",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-6",children:x("checkout.orderSummary")}),(0,t.jsx)("div",{className:"space-y-4 mb-6",children:e.map(e=>(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-lg overflow-hidden flex-shrink-0",children:e.image&&(0,t.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-slate-900 line-clamp-2",children:e.title}),(0,t.jsxs)("p",{className:"text-primary font-bold",children:["$",e.price.toFixed(2)]})]})]},e.id))}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:x("checkout.couponLabel")}),C?(0,t.jsxs)("div",{className:"flex justify-between items-center bg-green-50 border border-green-200 p-3 rounded-lg",children:[(0,t.jsxs)("span",{className:"text-green-700 font-medium flex items-center gap-2",children:[(0,t.jsx)(l,{className:"w-4 h-4"}),C," ",x("checkout.couponApplied")]}),(0,t.jsx)("button",{onClick:()=>{w(0),S(null),j(""),N("")},className:"text-red-500 hover:text-red-700 text-sm font-medium",children:x("checkout.remove")})]}):(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:y,onChange:e=>j(e.target.value.toUpperCase()),placeholder:x("checkout.couponPlaceholder"),className:"flex-1 px-4 py-2 rounded-lg border border-slate-300 focus:ring-2 focus:ring-primary focus:border-transparent uppercase"}),(0,t.jsx)("button",{type:"button",onClick:J,disabled:!y,className:"bg-slate-800 text-white px-4 py-2 rounded-lg hover:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed",children:x("checkout.apply")})]}),v&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:v})]}),(0,t.jsxs)("div",{className:"border-t border-slate-200 pt-4 space-y-2 mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between text-slate-600",children:[(0,t.jsx)("span",{children:x("checkout.subtotal")}),(0,t.jsxs)("span",{children:["$",d.toFixed(2)]})]}),k>0&&(0,t.jsxs)("div",{className:"flex justify-between text-green-600 font-medium",children:[(0,t.jsx)("span",{children:x("checkout.discount")}),(0,t.jsxs)("span",{children:["-$",k.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-lg font-bold text-slate-900 border-t border-slate-200 pt-2 mt-2",children:[(0,t.jsx)("span",{children:x("checkout.total")}),(0,t.jsxs)("span",{children:["$",(d-k).toFixed(2)]})]})]}),(0,t.jsx)("button",{type:"submit",form:"checkout-form",disabled:p,className:"w-full bg-primary text-white py-4 rounded-xl font-bold text-lg hover:bg-[#D9012D] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?x("checkout.processing"):`${x("checkout.pay")} $${(d-k).toFixed(2)}`}),(0,t.jsx)("p",{className:"text-xs text-center text-slate-500 mt-4",children:x("checkout.terms")})]})})]})]})})}e.s(["default",()=>d],765179)}]);